---
title: Cause of Wildfires in California from 1878 - 2020
author: Lulus Adhitya
date: '2022-07-24'
categories:
  - california
  - wildfire
  - analysis
toc: true
code-fold: true
code-summary: Show the code
self-contained: true
image: image.jpg
jupyter: python3
---
Important facts about California Wildfire.

![](image.jpg)

## **1. Read data**

### 1.1. Import library & dataset

```{python}
# import library
import pandas as pd
import numpy as np
import geopandas as gpd
import matplotlib.pyplot as plt
import seaborn as sns
%matplotlib inline

import warnings
warnings.filterwarnings('ignore')

# read dataset 
df = gpd.read_file('fire20_1.gdb')
df
```

### 1.2. Data Summary

```{python}
#dataset information
df.info()
```

## **2. Aggregate the data**

### Pivoting
```{python}
from mitosheet import *; register_analysis("id-ynheayqgsj");
    
# Pivoted into df
tmp_df = df[['YEAR_', 'CAUSE']]
pivot_table = tmp_df.pivot_table(
    index=['YEAR_'],
    columns=['CAUSE'],
    values=['CAUSE'],
    aggfunc={'CAUSE': ['count']}
)
pivot_table.set_axis([flatten_column_header(col) for col in pivot_table.keys()], axis=1, inplace=True)
df_pivot = pivot_table.reset_index()

# sum df_pivot
cause = df_pivot.sum()

# create new frame
cause_df = cause.to_frame()
cause_df.reset_index(inplace=True)

# column names
cause_df.columns = ['CAUSE', 'COUNT']

# drop label '0'
cause_df = cause_df.drop(labels=0, axis=0)

# change format
cause_df['COUNT'] = cause_df['COUNT'].astype(int)

# sorting
cause_df = cause_df.sort_values(by=['COUNT'],ascending = False)

# extract string
cause_df['CAUSE'] = cause_df.CAUSE.str.extract('(\d+)')
cause_df
```

```{python}
cause_df['CAUSE'] = cause_df.CAUSE.str.extract('(\d+)')
cause_df
```


### Create categories

```{python}
cause_code = {'CAUSE':['1','2', '3', '4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19'], 
        'Description':['Lightning','Equipment Use','Smoking','Campfire','Debris','Railroad','Arson','Playing with Fire','Miscellaneous','Vehicle','Power Line','Firefighter Training','Non-Firefighter Training','Unidentified','Structure','Aircraft','Volcanic','Escaped Prescribed Burn','Illegal Alien Campfire']}
cause_code = pd.DataFrame(cause_code)
cause_code
```


```{python}
cause_final = pd.merge(cause_df,cause_code,left_on='CAUSE',right_on='CAUSE')
```

```{python}
cause_final = cause_final[['Description','COUNT']]
cause_final
```

### Data visualization

```{python}
ax = sns.barplot(x = 'COUNT', y = 'Description' , data = cause_final);
sns.set_context("paper")
plt.title(" Wildfire by cause from 1878 -2020")
plt.savefig("wildfire_by_cause.png")
plt.show()
```


## **3. Source** 
![](fraplogo.jpg)

Website : https://frap.fire.ca.gov/

